<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:conv="clr-namespace:Playnite.DesktopApp.Avalonia.Converters"
        x:Class="Playnite.DesktopApp.Avalonia.Views.Dialogs.CommandPaletteWindow"
        Width="860"
        Height="520"
        MinWidth="560"
        MinHeight="360"
        Background="{DynamicResource ShellContentBrush}"
        WindowStartupLocation="CenterOwner"
        CanResize="True">
  <Window.Resources>
    <conv:StringNotEmptyConverter x:Key="StringNotEmptyConverter" />
  </Window.Resources>

  <Grid RowDefinitions="Auto,Auto,*,Auto" Margin="16">
    <TextBlock Text="{Binding Title}"
               FontSize="18"
               FontWeight="SemiBold"
               Foreground="{DynamicResource ShellTextBrush}"
               Margin="0,0,0,12" />

    <StackPanel Grid.Row="1" Spacing="8" Margin="0,0,0,12">
      <TextBox x:Name="FilterBox"
               Watermark="Type to filterâ€¦"
               Text="{Binding FilterText, UpdateSourceTrigger=PropertyChanged}" />
      <TextBlock Text="{Binding StatusText}"
                 Foreground="{DynamicResource ShellMutedTextBrush}"
                 IsVisible="{Binding StatusText, Converter={StaticResource StringNotEmptyConverter}}" />
    </StackPanel>

    <Border Grid.Row="2"
            Background="{DynamicResource ShellCardBrush}"
            BorderBrush="{DynamicResource ShellItemBorderBrush}"
            BorderThickness="1"
            CornerRadius="6"
            Padding="8"
            Margin="0,0,0,12">
      <ListBox x:Name="ItemsList"
               ItemsSource="{Binding FilteredItems}"
               SelectedItem="{Binding SelectedItem}"
               Background="Transparent"
               BorderThickness="0"
               DoubleTapped="OnItemsDoubleTapped">
        <ListBox.ItemTemplate>
          <DataTemplate>
            <StackPanel Spacing="2" Margin="4">
              <TextBlock Text="{Binding DisplayLabel}"
                         Foreground="{DynamicResource ShellTextBrush}"
                         FontSize="14" />
              <TextBlock Text="{Binding Description}"
                         Foreground="{DynamicResource ShellMutedTextBrush}"
                         FontSize="12"
                         TextTrimming="CharacterEllipsis" />
            </StackPanel>
          </DataTemplate>
        </ListBox.ItemTemplate>
      </ListBox>
    </Border>

    <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="8">
      <Button Content="Refresh" Command="{Binding RefreshCommand}" />
      <Button Content="Pin/Unpin" Command="{Binding TogglePinSelectedCommand}" IsEnabled="{Binding CanTogglePin}" />
      <Button Content="Run" Command="{Binding RunSelectedCommand}" IsEnabled="{Binding CanRun}" IsDefault="True" />
      <Button Content="Close" Click="OnCloseClick" IsCancel="True" />
    </StackPanel>
  </Grid>
</Window>
